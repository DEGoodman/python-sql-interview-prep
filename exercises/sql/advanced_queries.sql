-- Advanced SQL Queries Exercise  
-- Time limit: 10-15 minutes per exercise

-- Exercise 1: Complex Aggregation (12 minutes)
-- Create a report showing:
-- - Month/Year
-- - Total orders
-- - Total revenue 
-- - Average order value
-- - Number of unique customers
-- Only include months with at least 10 orders

-- TODO: Write your query here


-- Exercise 2: Self JOIN (10 minutes)
-- Find pairs of customers who live in the same city
-- Don't include the same customer twice (A,B should not also show B,A)

-- TODO: Write your query here


-- Exercise 3: Conditional Logic (8 minutes)
-- Categorize customers based on their total spending:
-- - 'High Value': > $1000
-- - 'Medium Value': $500-$1000  
-- - 'Low Value': < $500
-- Show customer name, total spent, and category

-- TODO: Write your query here


-- Exercise 4: Running Totals (15 minutes)
-- Show daily sales with:
-- - Date
-- - Daily sales amount
-- - Running total of sales
-- - Percentage of total sales to date

-- TODO: Write your query here


-- Exercise 5: Top N per Group (12 minutes)
-- Find the top 2 best-selling products in each category
-- Show category, product_name, total_quantity_sold, and rank within category

-- TODO: Write your query here


-- Exercise 6: Data Quality Check (8 minutes)
-- Write a query to find potential data issues:
-- - Orders with negative quantities
-- - Orders with null customer_id
-- - Customers with duplicate email addresses
-- - Products with price = 0

-- TODO: Write your query here